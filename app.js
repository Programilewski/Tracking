var map = L.map("map").setView([52.239876282953595, 21.009695687675006], 10);
L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png", {
  maxZoom: 19,
  attribution:
    '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
}).addTo(map);

const team = {
  rafalKolacz: {
    "2024-01-25": [
      [52.23498121406386, 21.272301474408646],
      [52.24716945294074, 21.301224984690645],
      [52.236885847051255, 21.296870907874],
      [52.24567890123456, 21.2890123456789],
      [52.237654321098765, 21.274321098765432],
      [52.24123456789012, 21.26789012345679],
      [52.24890123456789, 21.303456789012345],
      [52.23234567890123, 21.286789012345677],
      [52.2390123456789, 21.27890123456789],
      [52.22678901234567, 21.297890123456789],
    ],
    "2024-01-24": [
      [52.240504424564904, 21.16842564178299],
      [52.23040976143125, 21.176200778955568],
      [52.224694783594316, 21.19983719596021],
      [52.23654789123456, 21.1890123456789],
      [52.2201987654321, 21.202345678901234],
      [52.244567890123456, 21.17234567890123],
      [52.237654321098765, 21.194321098765432],
      [52.22890123456789, 21.18789012345679],
      [52.23234567890123, 21.17890123456789],
      [52.22678901234567, 21.209890123456789],
    ],
    "2024-01-23": [
      [52.19329854584873, 21.14346896171669],
      [52.19282993013169, 21.16984281348213],
      [52.17610357185383, 21.18099107887905],
      [52.183456789012345, 21.155432109876543],
      [52.19567890123456, 21.162345678901234],
      [52.184321098765432, 21.174321098765432],
      [52.19789012345679, 21.1490123456789],
      [52.186789012345677, 21.15890123456789],
      [52.193456789012345, 21.16890123456789],
      [52.17678901234567, 21.17989012345679],
    ],
  },
  konradKubicki: {
    "2024-01-25": [
      [52.19329854584873, 21.14346896171669],
      [52.19282993013169, 21.16984281348213],
      [52.17610357185383, 21.18099107887905],
      [52.183456789012345, 21.155432109876543],
      [52.19567890123456, 21.162345678901234],
      [52.184321098765432, 21.174321098765432],
      [52.19789012345679, 21.1490123456789],
      [52.186789012345677, 21.15890123456789],
      [52.193456789012345, 21.16890123456789],
      [52.17678901234567, 21.17989012345679],
    ],
    "2024-01-24": [
      [52.23498121406386, 21.272301474408646],
      [52.24716945294074, 21.301224984690645],
      [52.236885847051255, 21.296870907874],
      [52.24567890123456, 21.2890123456789],
      [52.237654321098765, 21.274321098765432],
      [52.24123456789012, 21.26789012345679],
      [52.24890123456789, 21.303456789012345],
      [52.23234567890123, 21.286789012345677],
      [52.2390123456789, 21.27890123456789],
      [52.22678901234567, 21.297890123456789],
    ],
    "2024-01-23": [
      [52.240504424564904, 21.16842564178299],
      [52.23040976143125, 21.176200778955568],
      [52.224694783594316, 21.19983719596021],
      [52.23654789123456, 21.1890123456789],
      [52.2201987654321, 21.202345678901234],
      [52.244567890123456, 21.17234567890123],
      [52.237654321098765, 21.194321098765432],
      [52.22890123456789, 21.18789012345679],
      [52.23234567890123, 21.17890123456789],
      [52.22678901234567, 21.209890123456789],
    ],
  },
  tomaszSkawski: {
    "2024-01-25": [
      [52.23498121406386, 21.272301474408646],
      [52.24716945294074, 21.301224984690645],
      [52.236885847051255, 21.296870907874],
      [52.24567890123456, 21.2890123456789],
      [52.237654321098765, 21.274321098765432],
      [52.24123456789012, 21.26789012345679],
      [52.24890123456789, 21.303456789012345],
      [52.23234567890123, 21.286789012345677],
      [52.2390123456789, 21.27890123456789],
      [52.22678901234567, 21.297890123456789],
    ],
    "2024-01-24": [
      [52.240504424564904, 21.16842564178299],
      [52.23040976143125, 21.176200778955568],
      [52.224694783594316, 21.19983719596021],
      [52.23654789123456, 21.1890123456789],
      [52.2201987654321, 21.202345678901234],
      [52.244567890123456, 21.17234567890123],
      [52.237654321098765, 21.194321098765432],
      [52.22890123456789, 21.18789012345679],
      [52.23234567890123, 21.17890123456789],
      [52.22678901234567, 21.209890123456789],
    ],
    "2024-01-23": [
      [52.19329854584873, 21.14346896171669],
      [52.19282993013169, 21.16984281348213],
      [52.17610357185383, 21.18099107887905],
      [52.183456789012345, 21.155432109876543],
      [52.19567890123456, 21.162345678901234],
      [52.184321098765432, 21.174321098765432],
      [52.19789012345679, 21.1490123456789],
      [52.186789012345677, 21.15890123456789],
      [52.193456789012345, 21.16890123456789],
      [52.17678901234567, 21.17989012345679],
    ],
  },
};
class Polyline {
  constructor(salesman) {
    this.salesman = salesman;
    this.polyline = null;
  }
  createPolyline(date) {
    console.log(this);
    this.polyline = L.polyline(team[this.salesman][date]);
    this.polyline.addTo(map);
  }
  removePolyline(date) {
    this.polyline.remove();
    this.date = date;
  }
}
const salesmanCheckboxes = document.querySelectorAll(".isChecked");

salesmanCheckboxes.forEach((salesman) => {
  let newPoly = null;
  salesman.addEventListener("click", () => {
    const date = document.querySelector("#datePicker").value;
    if (newPoly === null) {
      newPoly = new Polyline(salesman.id);
    }
    if (salesman.checked) newPoly.createPolyline(date);
    if (!salesman.checked) {
      console.log(newPoly);
      newPoly.removePolyline(date);
    }
  });
});

const membersState = {
  tomaszSkawski: {
    "2024-01-23": true,
    "2024-01-24": true,
    "2024-01-25": false,
  },
  konradKubicki: {
    "2024-01-23": true,
    "2024-01-24": true,
    "2024-01-25": false,
  },
  rafalKolacz: {
    "2024-01-23": true,
    "2024-01-24": true,
    "2024-01-25": false,
  },
};
const datePicker = document.querySelector("#datePicker");
datePicker.addEventListener("change", () => {
  salesmanCheckboxes.forEach((checkbox) => {
    checkbox.setAttribute("aria-label-date", datePicker.value);
    for (const [key, value] of Object.entries(membersState)) {
      if (key === checkbox.id) {
        console.log("found", key);
        for (const [k, v] of Object.entries(value)) {
          if (k === checkbox.getAttribute("aria-label-date")) {
            checkbox.checked = v;
          }
        }
      }
    }
  });
});
